<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><title>bluecms尝试审计</title><link rel="shortcut icon" href="/images/avatar.png"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css"><script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script></head><body><nav class="main-nav"><a href="/">Home</a><a href="/archives">Archives</a></nav><div class="profile"><section id="wrapper"><header id="header"><a href="/about"><img class="2x" id="avatar" src="/images/avatar.png"></a><h1>The clown is laughing at you</h1><h2></h2></header></section></div><section class="post" id="wrapper"><article><header><h1>bluecms尝试审计</h1><h2 class="headline">Jul 07, 2019 10:53·131 words
·1 minutes read<span class="tags"></span></h2></header><div id="toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01"><span class="toc-text">0x01</span></a></li></ol></div><section id="post-body"><p>这个cms好像洞很多，对于新手似乎比较友好，这个我打算自己试着去挖洞，持续更新….</p>
<h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p>第一个点在注册处，我们可以使用burpsuit，对注册时的数据包进行拦截修改，<br><img src="/2019/07/07/bluecms尝试审计/1.png" alt=""><br>看到数据是传入user.php<br>查看user.php，未有过滤。<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">"INSERT INTO "</span>.table(<span class="string">'user'</span>).<span class="string">" (user_id, user_name, pwd, email, reg_time, last_login_time) VALUES ('', '$user_name', md5('$pwd'), '$email', '$timestamp', '$timestamp')"</span>;</span><br></pre></td></tr></table></figure></p>
<p>可以进行存储型的xss攻击<br>构造<code>$email=&lt;script&gt;alert(1)&lt;/script&gt;123@qq.com</code><br><img src="/2019/07/07/bluecms尝试审计/2.png" alt=""><br><img src="/2019/07/07/bluecms尝试审计/3.png" alt=""><br>我们查看源代码<br><img src="/2019/07/07/bluecms尝试审计/4.png" alt=""></p>
</section><nav id="post-nav"><span class="prev"><a href="/2019/07/08/依葫芦画瓢之escapeshellarg-与escapeshellcmd/"><span class="arrow">←</span>Newer Posts</a></span><span class="next"><a href="/2019/07/01/CTF练习之命令执行漏洞/">Older Posts<span class="arrow">→</span></a></span></nav></article></section><footer id="footer"><div id="social"><a class="symbol" href="https://github.com/fuzhouxxdong"><i class="fa fa-github"></i></a></div><p class="small">© Copyright 2018 &nbsp;<i class="fa fa-heart" aria-hidden="true">&nbsp;Dxx</i></p><p class="small">Powered by &nbsp;<a href="https://hexo.io/">Hexo &nbsp;</a>Theme By &nbsp;<a href="https://github.com/fuzhouxxdong/hexo-theme-dxx">Dxx</a></p></footer><script>hljs.initHighlightingOnLoad();</script></body></html>